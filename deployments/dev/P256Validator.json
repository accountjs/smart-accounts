{
  "address": "0x887223D60bb5a3865Db094C7b0e3E6CDb12ACc19",
  "abi": [
    {
      "inputs": [
        {
          "internalType": "contract ISecp256r1",
          "name": "_impl",
          "type": "address"
        }
      ],
      "stateMutability": "nonpayable",
      "type": "constructor"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "address",
          "name": "account",
          "type": "address"
        },
        {
          "indexed": false,
          "internalType": "bytes",
          "name": "oldPk",
          "type": "bytes"
        },
        {
          "indexed": false,
          "internalType": "bytes",
          "name": "newPk",
          "type": "bytes"
        }
      ],
      "name": "PkChanged",
      "type": "event"
    },
    {
      "inputs": [],
      "name": "NAME",
      "outputs": [
        {
          "internalType": "string",
          "name": "",
          "type": "string"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "VERSION",
      "outputs": [
        {
          "internalType": "string",
          "name": "",
          "type": "string"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes",
          "name": "data",
          "type": "bytes"
        }
      ],
      "name": "enable",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "impl",
      "outputs": [
        {
          "internalType": "contract ISecp256r1",
          "name": "",
          "type": "address"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "",
          "type": "address"
        }
      ],
      "name": "pks",
      "outputs": [
        {
          "internalType": "bytes",
          "name": "",
          "type": "bytes"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "account",
          "type": "address"
        },
        {
          "internalType": "bytes32",
          "name": "userOpHash",
          "type": "bytes32"
        },
        {
          "internalType": "bytes",
          "name": "signature",
          "type": "bytes"
        }
      ],
      "name": "validateSignature",
      "outputs": [
        {
          "internalType": "uint256",
          "name": "validationData",
          "type": "uint256"
        }
      ],
      "stateMutability": "payable",
      "type": "function"
    }
  ],
  "transactionHash": "0x22705debc78bde2611a1e46db21b4591f442332a681f9797b1c8153aeb1e8e49",
  "receipt": {
    "to": "0x4e59b44847b379578588920cA78FbF26c0B4956C",
    "from": "0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266",
    "contractAddress": null,
    "transactionIndex": 0,
    "gasUsed": "548506",
    "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    "blockHash": "0x773592ff89280c1e7f6d96897ebb57427b1a4f5d09b9015810fc6fc35be488a9",
    "transactionHash": "0x22705debc78bde2611a1e46db21b4591f442332a681f9797b1c8153aeb1e8e49",
    "logs": [],
    "blockNumber": 7,
    "cumulativeGasUsed": "548506",
    "status": 1,
    "byzantium": true
  },
  "args": [
    "0xA301eCD54d9D1Ac089ee9c65d5B4Fc412A0bc2A2"
  ],
  "numDeployments": 1,
  "solcInputHash": "e7b5f1c1bc37ac4da0d4db039ee1af4c",
  "metadata": "{\"compiler\":{\"version\":\"0.8.19+commit.7dd6d404\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"contract ISecp256r1\",\"name\":\"_impl\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"account\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"bytes\",\"name\":\"oldPk\",\"type\":\"bytes\"},{\"indexed\":false,\"internalType\":\"bytes\",\"name\":\"newPk\",\"type\":\"bytes\"}],\"name\":\"PkChanged\",\"type\":\"event\"},{\"inputs\":[],\"name\":\"NAME\",\"outputs\":[{\"internalType\":\"string\",\"name\":\"\",\"type\":\"string\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"VERSION\",\"outputs\":[{\"internalType\":\"string\",\"name\":\"\",\"type\":\"string\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes\",\"name\":\"data\",\"type\":\"bytes\"}],\"name\":\"enable\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"impl\",\"outputs\":[{\"internalType\":\"contract ISecp256r1\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"name\":\"pks\",\"outputs\":[{\"internalType\":\"bytes\",\"name\":\"\",\"type\":\"bytes\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"account\",\"type\":\"address\"},{\"internalType\":\"bytes32\",\"name\":\"userOpHash\",\"type\":\"bytes32\"},{\"internalType\":\"bytes\",\"name\":\"signature\",\"type\":\"bytes\"}],\"name\":\"validateSignature\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"validationData\",\"type\":\"uint256\"}],\"stateMutability\":\"payable\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"contracts/validators/p256/P256Validator.sol\":\"P256Validator\"},\"evmVersion\":\"paris\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"none\",\"useLiteralContent\":true},\"optimizer\":{\"enabled\":true,\"runs\":800},\"remappings\":[]},\"sources\":{\"contracts/common/Contants.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\npragma solidity 0.8.19;\\n\\nlibrary Contants {\\n    address internal constant SENTINEL = address(0x1);\\n\\n    uint256 internal constant SIG_VALIDATION_FAILED = 1;\\n}\\n\",\"keccak256\":\"0x4def4c34ea7d1925f182376cda97a69c536491aa43ebadaaf710b58173f5f76b\",\"license\":\"MIT\"},\"contracts/interfaces/IValidator.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\npragma solidity 0.8.19;\\n\\nimport \\\"./Metadata.sol\\\";\\n\\ninterface IValidator is Metadata {\\n    function validateSignature(address account, bytes32 userOpHash, bytes calldata signature)\\n        external\\n        payable\\n        returns (uint256 validationData);\\n\\n    function enable(bytes calldata data) external;\\n}\\n\",\"keccak256\":\"0x5db68ebccae27e64cd2f7b0ac9ab0f964eaae5e505e625dfff97503eba89cf4d\",\"license\":\"MIT\"},\"contracts/interfaces/Metadata.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\npragma solidity 0.8.19;\\n\\ninterface Metadata {\\n    function NAME() external view returns (string memory);\\n    function VERSION() external view returns (string memory);\\n}\\n\",\"keccak256\":\"0xb2873bb7dd77abc60985f548ae9227d94ba79db679314701bb73a9d5e93fca0c\",\"license\":\"MIT\"},\"contracts/validators/p256/ISecp256r1.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\npragma solidity 0.8.19;\\n\\ninterface ISecp256r1 {\\n    function validateSignature(bytes32 message, bytes calldata signature, bytes calldata publicKey)\\n        external\\n        view\\n        returns (bool);\\n}\\n\",\"keccak256\":\"0x2c27d09b504eebfad02daf6a774b8df8bf29c51077f288bf6dd5464b4a18d177\",\"license\":\"MIT\"},\"contracts/validators/p256/P256Validator.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\npragma solidity 0.8.19;\\n\\nimport \\\"../../interfaces/IValidator.sol\\\";\\nimport \\\"../../common/Contants.sol\\\";\\nimport \\\"./ISecp256r1.sol\\\";\\n\\ncontract P256Validator is IValidator {\\n    string public constant override NAME = \\\"P256 Validator\\\";\\n    string public constant override VERSION = \\\"0.0.1\\\";\\n\\n    event PkChanged(address indexed account, bytes oldPk, bytes newPk);\\n\\n    ISecp256r1 public immutable impl;\\n    mapping(address => bytes) public pks;\\n\\n    constructor(ISecp256r1 _impl) {\\n        impl = _impl;\\n    }\\n\\n    function validateSignature(address account, bytes32 userOpHash, bytes calldata signature)\\n        external\\n        payable\\n        override\\n        returns (uint256 validationData)\\n    {\\n        if (impl.validateSignature(sha256(abi.encode(userOpHash)), signature, pks[account])) {\\n            return 0;\\n        }\\n        return Contants.SIG_VALIDATION_FAILED;\\n    }\\n\\n    function enable(bytes calldata data) external override {\\n        pks[msg.sender] = data;\\n        bytes memory old = pks[msg.sender];\\n        emit PkChanged(msg.sender, old, data);\\n    }\\n}\\n\",\"keccak256\":\"0x4267be46276917318d2788dd966f64b264ceb89080244152b3994d6df424c78c\",\"license\":\"MIT\"}},\"version\":1}",
  "bytecode": "0x60a060405234801561001057600080fd5b5060405161097f38038061097f83398101604081905261002f91610040565b6001600160a01b0316608052610070565b60006020828403121561005257600080fd5b81516001600160a01b038116811461006957600080fd5b9392505050565b6080516108ee61009160003960008181609e015261035a01526108ee6000f3fe6080604052600436106100655760003560e01c8063971604c611610043578063971604c61461010a578063a3f4df7e1461012b578063ffa1ad741461017457600080fd5b80630c9595561461006a5780638abf60771461008c5780639356375c146100dd575b600080fd5b34801561007657600080fd5b5061008a6100853660046104f0565b6101bd565b005b34801561009857600080fd5b506100c07f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b0390911681526020015b60405180910390f35b3480156100e957600080fd5b506100fd6100f836600461054e565b6102bc565b6040516100d491906105c0565b61011d6101183660046105d3565b610356565b6040519081526020016100d4565b34801561013757600080fd5b506100fd6040518060400160405280600e81526020017f503235362056616c696461746f7200000000000000000000000000000000000081525081565b34801561018057600080fd5b506100fd6040518060400160405280600581526020017f302e302e3100000000000000000000000000000000000000000000000000000081525081565b3360009081526020819052604090206101d78284836106cc565b5033600090815260208190526040812080546101f290610643565b80601f016020809104026020016040519081016040528092919081815260200182805461021e90610643565b801561026b5780601f106102405761010080835404028352916020019161026b565b820191906000526020600020905b81548152906001019060200180831161024e57829003601f168201915b50505050509050336001600160a01b03167f49a125229beaa1b288f0f807170a37c7a131925683b0250b113db84181bfb0668285856040516102af939291906107b6565b60405180910390a2505050565b600060208190529081526040902080546102d590610643565b80601f016020809104026020016040519081016040528092919081815260200182805461030190610643565b801561034e5780601f106103235761010080835404028352916020019161034e565b820191906000526020600020905b81548152906001019060200180831161033157829003601f168201915b505050505081565b60007f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663ae7e17f060028660405160200161039c91815260200190565b60408051601f19818403018152908290526103b6916107e6565b602060405180830381855afa1580156103d3573d6000803e3d6000fd5b5050506040513d601f19601f820116820180604052508101906103f69190610802565b6001600160a01b0388166000908152602081905260409081902090517fffffffff0000000000000000000000000000000000000000000000000000000060e085901b16815261044d9291889188919060040161081b565b602060405180830381865afa15801561046a573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061048e91906108bf565b1561049b5750600061049f565b5060015b949350505050565b60008083601f8401126104b957600080fd5b50813567ffffffffffffffff8111156104d157600080fd5b6020830191508360208285010111156104e957600080fd5b9250929050565b6000806020838503121561050357600080fd5b823567ffffffffffffffff81111561051a57600080fd5b610526858286016104a7565b90969095509350505050565b80356001600160a01b038116811461054957600080fd5b919050565b60006020828403121561056057600080fd5b61056982610532565b9392505050565b60005b8381101561058b578181015183820152602001610573565b50506000910152565b600081518084526105ac816020860160208601610570565b601f01601f19169290920160200192915050565b6020815260006105696020830184610594565b600080600080606085870312156105e957600080fd5b6105f285610532565b935060208501359250604085013567ffffffffffffffff81111561061557600080fd5b610621878288016104a7565b95989497509550505050565b634e487b7160e01b600052604160045260246000fd5b600181811c9082168061065757607f821691505b60208210810361067757634e487b7160e01b600052602260045260246000fd5b50919050565b601f8211156106c757600081815260208120601f850160051c810160208610156106a45750805b601f850160051c820191505b818110156106c3578281556001016106b0565b5050505b505050565b67ffffffffffffffff8311156106e4576106e461062d565b6106f8836106f28354610643565b8361067d565b6000601f84116001811461072c57600085156107145750838201355b600019600387901b1c1916600186901b178355610786565b600083815260209020601f19861690835b8281101561075d578685013582556020948501946001909201910161073d565b508682101561077a5760001960f88860031b161c19848701351681555b505060018560011b0183555b5050505050565b81835281816020850137506000828201602090810191909152601f909101601f19169091010190565b6040815260006107c96040830186610594565b82810360208401526107dc81858761078d565b9695505050505050565b600082516107f8818460208701610570565b9190910192915050565b60006020828403121561081457600080fd5b5051919050565b8481526000602060608184015261083660608401868861078d565b83810360408501526000855461084b81610643565b808452600182811680156108665760018114610880576108ae565b60ff1984168688015282151560051b8601870194506108ae565b896000528660002060005b848110156108a65781548882018a015290830190880161088b565b870188019550505b50929b9a5050505050505050505050565b6000602082840312156108d157600080fd5b8151801515811461056957600080fdfea164736f6c6343000813000a",
  "deployedBytecode": "0x6080604052600436106100655760003560e01c8063971604c611610043578063971604c61461010a578063a3f4df7e1461012b578063ffa1ad741461017457600080fd5b80630c9595561461006a5780638abf60771461008c5780639356375c146100dd575b600080fd5b34801561007657600080fd5b5061008a6100853660046104f0565b6101bd565b005b34801561009857600080fd5b506100c07f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b0390911681526020015b60405180910390f35b3480156100e957600080fd5b506100fd6100f836600461054e565b6102bc565b6040516100d491906105c0565b61011d6101183660046105d3565b610356565b6040519081526020016100d4565b34801561013757600080fd5b506100fd6040518060400160405280600e81526020017f503235362056616c696461746f7200000000000000000000000000000000000081525081565b34801561018057600080fd5b506100fd6040518060400160405280600581526020017f302e302e3100000000000000000000000000000000000000000000000000000081525081565b3360009081526020819052604090206101d78284836106cc565b5033600090815260208190526040812080546101f290610643565b80601f016020809104026020016040519081016040528092919081815260200182805461021e90610643565b801561026b5780601f106102405761010080835404028352916020019161026b565b820191906000526020600020905b81548152906001019060200180831161024e57829003601f168201915b50505050509050336001600160a01b03167f49a125229beaa1b288f0f807170a37c7a131925683b0250b113db84181bfb0668285856040516102af939291906107b6565b60405180910390a2505050565b600060208190529081526040902080546102d590610643565b80601f016020809104026020016040519081016040528092919081815260200182805461030190610643565b801561034e5780601f106103235761010080835404028352916020019161034e565b820191906000526020600020905b81548152906001019060200180831161033157829003601f168201915b505050505081565b60007f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663ae7e17f060028660405160200161039c91815260200190565b60408051601f19818403018152908290526103b6916107e6565b602060405180830381855afa1580156103d3573d6000803e3d6000fd5b5050506040513d601f19601f820116820180604052508101906103f69190610802565b6001600160a01b0388166000908152602081905260409081902090517fffffffff0000000000000000000000000000000000000000000000000000000060e085901b16815261044d9291889188919060040161081b565b602060405180830381865afa15801561046a573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061048e91906108bf565b1561049b5750600061049f565b5060015b949350505050565b60008083601f8401126104b957600080fd5b50813567ffffffffffffffff8111156104d157600080fd5b6020830191508360208285010111156104e957600080fd5b9250929050565b6000806020838503121561050357600080fd5b823567ffffffffffffffff81111561051a57600080fd5b610526858286016104a7565b90969095509350505050565b80356001600160a01b038116811461054957600080fd5b919050565b60006020828403121561056057600080fd5b61056982610532565b9392505050565b60005b8381101561058b578181015183820152602001610573565b50506000910152565b600081518084526105ac816020860160208601610570565b601f01601f19169290920160200192915050565b6020815260006105696020830184610594565b600080600080606085870312156105e957600080fd5b6105f285610532565b935060208501359250604085013567ffffffffffffffff81111561061557600080fd5b610621878288016104a7565b95989497509550505050565b634e487b7160e01b600052604160045260246000fd5b600181811c9082168061065757607f821691505b60208210810361067757634e487b7160e01b600052602260045260246000fd5b50919050565b601f8211156106c757600081815260208120601f850160051c810160208610156106a45750805b601f850160051c820191505b818110156106c3578281556001016106b0565b5050505b505050565b67ffffffffffffffff8311156106e4576106e461062d565b6106f8836106f28354610643565b8361067d565b6000601f84116001811461072c57600085156107145750838201355b600019600387901b1c1916600186901b178355610786565b600083815260209020601f19861690835b8281101561075d578685013582556020948501946001909201910161073d565b508682101561077a5760001960f88860031b161c19848701351681555b505060018560011b0183555b5050505050565b81835281816020850137506000828201602090810191909152601f909101601f19169091010190565b6040815260006107c96040830186610594565b82810360208401526107dc81858761078d565b9695505050505050565b600082516107f8818460208701610570565b9190910192915050565b60006020828403121561081457600080fd5b5051919050565b8481526000602060608184015261083660608401868861078d565b83810360408501526000855461084b81610643565b808452600182811680156108665760018114610880576108ae565b60ff1984168688015282151560051b8601870194506108ae565b896000528660002060005b848110156108a65781548882018a015290830190880161088b565b870188019550505b50929b9a5050505050505050505050565b6000602082840312156108d157600080fd5b8151801515811461056957600080fdfea164736f6c6343000813000a",
  "devdoc": {
    "kind": "dev",
    "methods": {},
    "version": 1
  },
  "userdoc": {
    "kind": "user",
    "methods": {},
    "version": 1
  },
  "storageLayout": {
    "storage": [
      {
        "astId": 9238,
        "contract": "contracts/validators/p256/P256Validator.sol:P256Validator",
        "label": "pks",
        "offset": 0,
        "slot": "0",
        "type": "t_mapping(t_address,t_bytes_storage)"
      }
    ],
    "types": {
      "t_address": {
        "encoding": "inplace",
        "label": "address",
        "numberOfBytes": "20"
      },
      "t_bytes_storage": {
        "encoding": "bytes",
        "label": "bytes",
        "numberOfBytes": "32"
      },
      "t_mapping(t_address,t_bytes_storage)": {
        "encoding": "mapping",
        "key": "t_address",
        "label": "mapping(address => bytes)",
        "numberOfBytes": "32",
        "value": "t_bytes_storage"
      }
    }
  }
}